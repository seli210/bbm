<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ°ÙƒØ±Ø© BBM - New Vision</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { --gold: #C69C3A; --black: #050505; --success: #27ae60; --error: #c0392b; }
        * { box-sizing: border-box; }
        body {
            font-family: 'Cairo', sans-serif; background-color: var(--black); color: #fff;
            display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; padding: 15px;
        }
        
        /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„ØªØ°ÙƒØ±Ø© (Ø²ÙŠ Ù…Ø§ Ù‡Ùˆ) */
        .bridge-container { position: absolute; bottom: 0; left: 0; width: 100%; height: 60%; z-index: 0; opacity: 0.3; pointer-events: none; }
        .ticket-card {
            background: rgba(26, 26, 26, 0.95); backdrop-filter: blur(10px); width: 100%; max-width: 400px;
            border-radius: 20px; border: 1px solid var(--gold); text-align: center; position: relative; z-index: 10;
            display: none; /* Ù…Ø®ÙÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
        }
        .ticket-active { display: block; }
        .header { background: #000; padding: 20px; border-bottom: 2px solid var(--gold); display: flex; justify-content: center; gap: 15px; }
        .logo { height: 60px; object-fit: contain; }
        .nv-logo { height: 90px; }
        .content { padding: 30px 20px; }
        .user-name { font-size: 1.8rem; margin: 10px 0; font-weight: 700; }
        .id-badge { background: var(--gold); color: #000; padding: 5px 25px; border-radius: 4px; font-weight: 900; font-size: 1.4rem; font-family: monospace; }
        .status-box { border: 2px solid var(--success); color: var(--success); padding: 10px; border-radius: 10px; font-weight: bold; margin-bottom: 20px; }
        .error-mode .status-box { border-color: var(--error); color: var(--error); }
        
        /* Ø³ØªØ§ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† (Ø§Ù„Ø¬Ø¯ÙŠØ¯) */
        .admin-panel {
            background: #fff; color: #333; padding: 20px; border-radius: 10px; width: 100%; max-width: 600px;
            display: none; z-index: 20; text-align: center;
        }
        .admin-active { display: block; }
        textarea { width: 100%; height: 150px; margin: 10px 0; padding: 10px; direction: ltr; }
        button { background: var(--gold); color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; border-radius: 5px; }
    </style>
</head>
<body>

    <div class="ticket-card" id="card">
        <div class="header">
            <img src="logo_nv.png" alt="NV" class="logo nv-logo">
            <img src="logo_bbm.png" alt="BBM" class="logo">
        </div>
        <div class="content">
            <h1 class="user-name" id="userName">...</h1>
            <div class="id-badge" id="userId">...</div>
            <div class="status-box" id="statusBox">Access Granted âœ…</div>
            <div id="clock" style="color:#aaa; font-family:monospace;">00:00:00</div>
        </div>
    </div>

    <div class="admin-panel" id="adminPanel">
        <h2>ğŸ› ï¸ Ù…ÙˆÙ„Ø¯ Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª Ø§Ù„Ø³Ø­Ø±ÙŠ</h2>
        <p>Ø§Ù†Ø³Ø® Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ÙˆØ¹Ù…ÙˆØ¯ Ø§Ù„Ù€ ID Ù…Ù† Ø§Ù„Ø¥ÙƒØ³Ù„ ÙˆØ­Ø·Ù‡Ù… Ù‡Ù†Ø§</p>
        <p style="font-size: 12px; color: #666;">(Ø§Ù„Ø§Ø³Ù… ÙÙŠ Ø³Ø·Ø±ØŒ ÙˆØ§Ù„Ù€ ID Ø¬Ù†Ø¨Ù‡ Ø¨Ù…Ø³Ø§ÙØ© Ø£Ùˆ Tab)</p>
        <textarea id="inputData" placeholder="Example:
Ahmed Ali	101
Mona Sayed	102"></textarea>
        <button onclick="generateLinks()">Generate Links ğŸš€</button>
        <div id="outputLinks" style="margin-top: 20px; text-align: left; max-height: 200px; overflow-y: scroll; background: #eee; padding: 10px;"></div>
    </div>

    <script>
        // 1. ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆØ¶Ø¹ (ØªØ°ÙƒØ±Ø© ÙˆÙ„Ø§ Ø£Ø¯Ù…Ù†ØŸ)
        const params = new URLSearchParams(window.location.search);
        
        if (params.get('admin') === 'true') {
            document.getElementById('adminPanel').classList.add('admin-active');
        } else {
            document.getElementById('card').classList.add('ticket-active');
            checkTicket();
        }

        // --- ÙƒÙˆØ¯ Ø§Ù„ØªØ°ÙƒØ±Ø© (The Joker Script V3) ---
        function checkTicket() {
            const data = params.get('data');
            const nameEl = document.getElementById('userName');
            const idEl = document.getElementById('userId');
            const status = document.getElementById('statusBox');
            const card = document.getElementById('card');

            if (data && data.includes('__')) {
                const parts = data.split('__');
                nameEl.innerText = parts[0].replace(/%20/g, ' '); // ØªØµÙ„ÙŠØ­ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª
                idEl.innerText = parts[1];
            } else {
                // ØªØ¬Ø±Ø¨Ø© ÙŠØ¯ÙˆÙŠØ© (Test)
                if (data === 'test') {
                     nameEl.innerText = "Test User"; idEl.innerText = "000"; return;
                }
                card.classList.add('error-mode');
                nameEl.innerText = "Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©";
                idEl.innerText = "---";
                status.innerText = "Access Denied âŒ";
            }
        }

        // --- ÙƒÙˆØ¯ Ø§Ù„Ø£Ø¯Ù…Ù† (ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª) ---
        function generateLinks() {
            const input = document.getElementById('inputData').value.trim();
            const lines = input.split('\n');
            let output = "<h3>Ø®Ø¯ Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª Ø¯ÙŠ ÙƒÙˆØ¨ÙŠ ÙˆÙˆØ²Ø¹Ù‡Ø§:</h3>";
            
            lines.forEach(line => {
                // Ø¨Ù†ÙØµÙ„ Ø§Ù„Ø§Ø³Ù… Ø¹Ù† Ø§Ù„Ø±Ù‚Ù… (Ø¨ÙŠÙØµÙ„ Ø¨Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„Ù„ÙŠ Ø¨ÙŠÙ†Ù‡Ù…)
                // Ù„Ùˆ Ø§Ù„Ø§Ø³Ù… Ù…Ø±ÙƒØ¨ØŒ Ø¨Ù†Ø§Ø®Ø¯ Ø¢Ø®Ø± Ø¬Ø²Ø¡ ÙƒØ±Ù‚Ù…
                let parts = line.trim().split(/\t|    |  /); // Ø¨ÙŠÙØµÙ„ Ø¨Ø§Ù„Ù€ Tab Ø£Ùˆ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
                if (parts.length < 2) parts = line.trim().split(' '); // Ù…Ø­Ø§ÙˆÙ„Ø© ÙØµÙ„ Ø¨Ù…Ø³Ø§ÙØ© Ø¹Ø§Ø¯ÙŠØ©

                // Ø§ÙØªØ±Ø§Ø¶: Ø¢Ø®Ø± Ø­Ø§Ø¬Ø© Ù‡ÙŠ Ø§Ù„Ù€ IDØŒ ÙˆÙƒÙ„ Ø§Ù„Ù„ÙŠ Ù‚Ø¨Ù„Ù‡Ø§ Ù‡Ùˆ Ø§Ù„Ø§Ø³Ù…
                const id = parts.pop(); 
                const name = parts.join(' ');

                if (name && id) {
                    // ØªØµÙ„ÙŠØ­ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª ÙÙŠ Ø§Ù„Ø§Ø³Ù… Ù„Ù„ÙŠÙ†Ùƒ
                    const cleanName = name.trim();
                    const linkName = cleanName.replace(/ /g, '%20'); 
                    const fullLink = `https://seli210.github.io/bbm/?data=${linkName}__${id}`;
                    
                    output += `<div style="margin-bottom:10px; border-bottom:1px solid #ccc; padding-bottom:5px;">
                        <strong>${cleanName}:</strong><br>
                        <a href="${fullLink}" target="_blank">${fullLink}</a><br>
                        <a href="https://wa.me/?text=${fullLink}" style="color:green; font-weight:bold; text-decoration:none;">[Send WhatsApp ğŸ“²]</a>
                    </div>`;
                }
            });
            document.getElementById('outputLinks').innerHTML = output;
        }

        // Ø§Ù„Ø³Ø§Ø¹Ø©
        setInterval(() => {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString('en-US');
        }, 1000);
    </script>
</body>
</html>
